//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
//  THIS FILE IS GENERATED BY EASY BINDINGS, DO NOT MODIFY IT
//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

import Cocoa

//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
//    EBTextKnobShape
//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

class EBTextKnobShape : EBShape {
  private let mFilledBezierPath : NSBezierPath
  private var mIndex : Int

  //····················································································································
  //  Init
  //····················································································································

  init (_ inString: String,
        _ inOrigin : CGPoint,
        _ inFont : NSFont,
        _ inHorizontalAlignment : EBTextHorizontalAlignment,
        _ inVerticalAlignment : EBTextVerticalAlignment,
        _ inIndex : Int) {
    let textAttributes : [NSAttributedString.Key : Any] = [
      NSAttributedString.Key.font : inFont
    ]
    let size = inString.size (withAttributes: textAttributes)
    var p = inOrigin
    switch inHorizontalAlignment {
    case .left :
      ()
    case .center :
      p.x -= size.width / 2.0
    case .right :
      p.x -= size.width
    }
    switch inVerticalAlignment {
    case .above :
      ()
    case .center :
      p.y -= size.height / 2.0
    case .below :
      p.y -= size.height
    }
  //--- Bezier path
    mFilledBezierPath = inString.bezierPath (at: p, withAttributes: textAttributes)
    mIndex = inIndex
  //---
    super.init ()
  }

  //····················································································································

  private init (_ inBezierPath : NSBezierPath, _ inIndex : Int) {
    mFilledBezierPath = inBezierPath
    mIndex = inIndex
    super.init ()
  }

  //····················································································································
  //  transformedBy
  //····················································································································

  override func transformedBy (_ inAffineTransform : NSAffineTransform) -> EBShape {
    let result = EBTextKnobShape (inAffineTransform.transform (self.mFilledBezierPath), self.mIndex)
    self.internalTransform (result, by: inAffineTransform)
    return result
  }

  //····················································································································

  private var knobRect : NSRect {
    return self.mFilledBezierPath.bounds.insetBy(dx: -0.5, dy: -0.5)
  }

  //····················································································································
  //   Knob Index
  //····················································································································

  override func knobIndex (at inPoint : NSPoint) -> Int? {
    if self.knobRect.contains (inPoint) {
      return self.mIndex
    }else{
      return super.knobIndex (at: inPoint)
    }
  }

  //····················································································································
  //  Draw Rect
  //····················································································································

  override func draw (_ inView : NSView, _ inDirtyRect: NSRect) {
    super.draw (inView, inDirtyRect)
    if inView.needsToDraw (self.knobRect) {
      NSColor.white.setFill ()
      NSBezierPath.fill (self.knobRect)
      NSBezierPath.defaultLineWidth = 0.0
      NSColor.black.setStroke ()
      NSBezierPath.stroke (self.knobRect)
      NSColor.black.setFill ()
      self.mFilledBezierPath.fill ()
    }
  }

  //····················································································································
  // boundingBox
  //····················································································································

  override internal var internalBoundingBox : NSRect {
    return self.knobRect
  }

  //····················································································································
  //   Contains point
  //····················································································································

  override func contains (point inPoint : NSPoint) -> Bool {
    var result = super.contains (point: inPoint)
    if !result {
      result = self.mFilledBezierPath.bounds.contains (inPoint)
    }
    return result
  }

  //····················································································································
  //   intersects
  //····················································································································

  override func intersects (rect inRect : NSRect) -> Bool {
    var result = super.intersects (rect: inRect)
    if !result {
      result = self.mFilledBezierPath.bounds.intersects (inRect)
    }
    return result
  }

  //····················································································································
  /// The hash value.
  ///
  /// Hash values are not guaranteed to be equal across different executions of
  /// your program. Do not save hash values to use during a future execution.
  //····················································································································

  override func hash (into hasher: inout Hasher) {
    super.hash (into: &hasher)
    self.mFilledBezierPath.hash (into: &hasher)
    self.mIndex.hash (into: &hasher)
  }

  //····················································································································
  //   isEqualToShape
  //····················································································································

  override func isEqualToShape (_ inOperand : EBShape) -> Bool {
    var equal = false
    if let operand = inOperand as? EBTextKnobShape {
      equal = self.mFilledBezierPath == operand.mFilledBezierPath
      if equal {
        equal = self.mIndex == operand.mIndex
      }
      if equal {
        equal = super.isEqualToShape (operand)
      }
    }
    return equal
  }

  //····················································································································

}

//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
