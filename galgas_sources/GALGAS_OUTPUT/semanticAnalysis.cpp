//---------------------------------------------------------------------------*
//                                                                           *
//                       File 'semanticAnalysis.cpp'                         *
//                        Generated by version 2.4.3                         *
//                    december 13th, 2012, at 17h29'11"                      *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "semanticAnalysis.h"
#include "galgas2/C_Compiler.h"
#include "galgas2/C_galgas_io.h"
#include "galgas2/C_galgas_CLI_Options.h"
#include "utilities/C_PrologueEpilogue.h"

//---------------------------------------------------------------------------*

#include "easyBindings_options.h"

//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "semanticAnalysis.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                        Routine 'semanticAnalysis'                         *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_semanticAnalysis (const GALGAS_cursorList constinArgument_inCursorList,
                               const GALGAS_classList constinArgument_inClassList,
                               const GALGAS_entityList constinArgument_inEntityList,
                               const GALGAS_preferencesDeclarationList constinArgument_inPreferencesList,
                               const GALGAS_outletClassList constinArgument_inOutletClassList,
                               const GALGAS_documentDeclarationList constinArgument_inDocumentDeclarationList,
                               const GALGAS_controllerClassList constinArgument_inControllerClassList,
                               const GALGAS_protocolList constinArgument_inProtocolList,
                               const GALGAS_location constinArgument_inEndOfSourceFile,
                               GALGAS_string inArgument_inSourceFilePath,
                               GALGAS_userCursorMap & outArgument_outCursorMap,
                               GALGAS_stringlist & outArgument_outPredefinedCursorList,
                               GALGAS_outletClassMap & outArgument_outOutletClassMap,
                               GALGAS_controllerClassMap & outArgument_outControllerClassMap,
                               GALGAS_classMap & outArgument_outClassMap,
                               GALGAS_entityMap & outArgument_outEntityMap,
                               GALGAS_preferencesMap & outArgument_outPreferencesMap,
                               GALGAS_documentMap & outArgument_outDocumentMap,
                               GALGAS_stringlist & outArgument_outSortedTransientOrderedList,
                               GALGAS__32_stringlist & outArgument_outTransientDependencyArcList,
                               C_Compiler * inCompiler
                               COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_outCursorMap.drop () ; // Release 'out' argument
  outArgument_outPredefinedCursorList.drop () ; // Release 'out' argument
  outArgument_outOutletClassMap.drop () ; // Release 'out' argument
  outArgument_outControllerClassMap.drop () ; // Release 'out' argument
  outArgument_outClassMap.drop () ; // Release 'out' argument
  outArgument_outEntityMap.drop () ; // Release 'out' argument
  outArgument_outPreferencesMap.drop () ; // Release 'out' argument
  outArgument_outDocumentMap.drop () ; // Release 'out' argument
  outArgument_outSortedTransientOrderedList.drop () ; // Release 'out' argument
  outArgument_outTransientDependencyArcList.drop () ; // Release 'out' argument
  //-------- @assignmentInstructionForGeneration
  outArgument_outCursorMap = GALGAS_userCursorMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (35)) ;
  //-------- @foreachInstructionForGeneration
  cEnumerator_cursorList enumerator_1257 (constinArgument_inCursorList, kEnumeration_up) ;
  //--- simple foreach instruction
  while (enumerator_1257.hasCurrentObject ()) {
    { //-------- @modifierCallInstructionForGeneration
    outArgument_outCursorMap.modifier_insertKey (enumerator_1257.current_mCursorName (HERE), enumerator_1257.current_mHotSpotX (HERE).mAttribute_double, enumerator_1257.current_mHotSpotY (HERE).mAttribute_double, inCompiler COMMA_SOURCE_FILE_AT_LINE (37)) ;
    } //-------- END @typeMethodInstructionForGeneration
    enumerator_1257.gotoNextObject () ;
  }
  //-------- @assignmentInstructionForGeneration
  outArgument_outPredefinedCursorList = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (39)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("arrowCursor") COMMA_SOURCE_FILE_AT_LINE (40)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("IBeamCursor") COMMA_SOURCE_FILE_AT_LINE (41)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("crosshairCursor") COMMA_SOURCE_FILE_AT_LINE (42)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("closedHandCursor") COMMA_SOURCE_FILE_AT_LINE (43)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("openHandCursor") COMMA_SOURCE_FILE_AT_LINE (44)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("pointingHandCursor") COMMA_SOURCE_FILE_AT_LINE (45)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeLeftCursor") COMMA_SOURCE_FILE_AT_LINE (46)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeRightCursor") COMMA_SOURCE_FILE_AT_LINE (47)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeLeftRightCursor") COMMA_SOURCE_FILE_AT_LINE (48)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeUpCursor") COMMA_SOURCE_FILE_AT_LINE (49)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeDownCursor") COMMA_SOURCE_FILE_AT_LINE (50)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("resizeUpDownCursor") COMMA_SOURCE_FILE_AT_LINE (51)) ;
  //-------- @plusEqualnstructionForGeneration
  outArgument_outPredefinedCursorList.addAssign_operation (GALGAS_string ("disappearingItemCursor") COMMA_SOURCE_FILE_AT_LINE (52)) ;
  //-------- @localVariableOrConstantDeclarationWithConstructorCallForGeneration
  GALGAS_protocolMap var_protocolMap = GALGAS_protocolMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (54)) ;
  //-------- @foreachInstructionForGeneration
  cEnumerator_protocolList enumerator_2168 (constinArgument_inProtocolList, kEnumeration_up) ;
  //--- simple foreach instruction
  while (enumerator_2168.hasCurrentObject ()) {
    { //-------- @modifierCallInstructionForGeneration
    var_protocolMap.modifier_insertKey (enumerator_2168.current_mProtocolName (HERE), inCompiler COMMA_SOURCE_FILE_AT_LINE (56)) ;
    } //-------- END @typeMethodInstructionForGeneration
    enumerator_2168.gotoNextObject () ;
  }
  //-------- @assignmentInstructionForGeneration
  outArgument_outSortedTransientOrderedList = GALGAS_stringlist::constructor_emptyList (SOURCE_FILE_AT_LINE (59)) ;
  //-------- @localVariableOrConstantDeclarationWithConstructorCallForGeneration
  GALGAS_transientDependencyGraph var_transientDependencyGraph = GALGAS_transientDependencyGraph::constructor_emptyGraph (SOURCE_FILE_AT_LINE (60)) ;
  { //-------- @routineCallInstructionForGeneration
  routine_analyzeOutletClasses (constinArgument_inOutletClassList, var_protocolMap, outArgument_outOutletClassMap, inCompiler COMMA_SOURCE_FILE_AT_LINE (61)) ;
  } //-------- @routineCallInstructionForGeneration
  { //-------- @routineCallInstructionForGeneration
  routine_analyzeControllerClasses (constinArgument_inControllerClassList, var_transientDependencyGraph, outArgument_outControllerClassMap, inCompiler COMMA_SOURCE_FILE_AT_LINE (62)) ;
  } //-------- @routineCallInstructionForGeneration
  { //-------- @routineCallInstructionForGeneration
  routine_analyzeClasses (constinArgument_inClassList, outArgument_outClassMap, var_transientDependencyGraph, inCompiler COMMA_SOURCE_FILE_AT_LINE (63)) ;
  } //-------- @routineCallInstructionForGeneration
  { //-------- @routineCallInstructionForGeneration
  routine_analyzePreferences (constinArgument_inPreferencesList, outArgument_outControllerClassMap, outArgument_outClassMap, outArgument_outOutletClassMap, outArgument_outPreferencesMap, var_transientDependencyGraph, inCompiler COMMA_SOURCE_FILE_AT_LINE (68)) ;
  } //-------- @routineCallInstructionForGeneration
  { //-------- @routineCallInstructionForGeneration
  routine_analyzeEntities (constinArgument_inEntityList, outArgument_outEntityMap, outArgument_outPreferencesMap, var_transientDependencyGraph, inCompiler COMMA_SOURCE_FILE_AT_LINE (76)) ;
  } //-------- @routineCallInstructionForGeneration
  { //-------- @routineCallInstructionForGeneration
  routine_analyzeDocuments (constinArgument_inDocumentDeclarationList, outArgument_outOutletClassMap, outArgument_outControllerClassMap, outArgument_outEntityMap, outArgument_outPreferencesMap, outArgument_outDocumentMap, var_transientDependencyGraph, inCompiler COMMA_SOURCE_FILE_AT_LINE (82)) ;
  } //-------- @routineCallInstructionForGeneration
  //-------- @ifInstructionForGeneration
  const enumGalgasBool test_0 = GALGAS_bool (kIsEqual, GALGAS_uint::constructor_errorCount (SOURCE_FILE_AT_LINE (92)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).operator_and (GALGAS_bool (gOption_easyBindings_5F_options_outputTransientDependencyGraph.reader_value ()) COMMA_SOURCE_FILE_AT_LINE (92)).boolEnum () ;
  if (kBoolTrue == test_0) {
    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
    GALGAS_string var_s = var_transientDependencyGraph.reader_graphviz (SOURCE_FILE_AT_LINE (93)) ;
    //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
    GALGAS_string var_path = inArgument_inSourceFilePath.operator_concat (GALGAS_string (".transientDependancyGraph.dot") COMMA_SOURCE_FILE_AT_LINE (94)) ;
    //-------- @methodCallInstructionForGeneration
    GALGAS_bool joker_3429_0 ; // Joker input parameter
    var_s.method_writeToFileWhenDifferentContents (var_path, joker_3429_0, inCompiler COMMA_SOURCE_FILE_AT_LINE (95)) ;
    //-------- END @methodCallInstructionForGeneration
  }
  //-------- @assignmentInstructionForGeneration
  outArgument_outTransientDependencyArcList = var_transientDependencyGraph.reader_arcs (SOURCE_FILE_AT_LINE (98)) ;
  //-------- @ifInstructionForGeneration
  const enumGalgasBool test_1 = GALGAS_bool (kIsEqual, GALGAS_uint::constructor_errorCount (SOURCE_FILE_AT_LINE (99)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
  if (kBoolTrue == test_1) {
    //-------- @ifInstructionForGeneration
    const enumGalgasBool test_2 = GALGAS_bool (kIsStrictSup, var_transientDependencyGraph.reader_undefinedNodeCount (SOURCE_FILE_AT_LINE (100)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
    if (kBoolTrue == test_2) {
      //-------- @foreachInstructionForGeneration
      cEnumerator_stringlist enumerator_3709 (var_transientDependencyGraph.reader_undefinedNodeKeyList (SOURCE_FILE_AT_LINE (101)), kEnumeration_up) ;
      //--- simple foreach instruction
      while (enumerator_3709.hasCurrentObject ()) {
        //-------- @errorInstructionForGeneration
        inCompiler->emitSemanticError (constinArgument_inEndOfSourceFile, GALGAS_string ("the '").operator_concat (enumerator_3709.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (102)).operator_concat (GALGAS_string ("' property is not defined") COMMA_SOURCE_FILE_AT_LINE (102)) COMMA_SOURCE_FILE_AT_LINE (102)) ;
        enumerator_3709.gotoNextObject () ;
      }
    }else if (kBoolFalse == test_2) {
      //-------- @localVariableDeclarationForGeneration
      GALGAS_stringlist var_unsortedTransientList ;
      //-------- @methodCallInstructionForGeneration
      GALGAS_lstringlist joker_3961_0 ; // Joker input parameter
      GALGAS_lstringlist joker_4003_0 ; // Joker input parameter
      var_transientDependencyGraph.method_topologicalSort (outArgument_outSortedTransientOrderedList, joker_3961_0, var_unsortedTransientList, joker_4003_0, inCompiler COMMA_SOURCE_FILE_AT_LINE (106)) ;
      //-------- END @methodCallInstructionForGeneration
      //-------- @ifInstructionForGeneration
      const enumGalgasBool test_3 = GALGAS_bool (kIsStrictSup, var_unsortedTransientList.reader_length (SOURCE_FILE_AT_LINE (112)).objectCompare (GALGAS_uint ((PMUInt32) 0U))).boolEnum () ;
      if (kBoolTrue == test_3) {
        //-------- @localVariableOrConstantDeclarationWithSourceExpressionForGeneration
        GALGAS_string var_s = var_unsortedTransientList.reader_length (SOURCE_FILE_AT_LINE (113)).reader_string (SOURCE_FILE_AT_LINE (113)).operator_concat (GALGAS_string (" transient declarations are involved in circular dependancies:") COMMA_SOURCE_FILE_AT_LINE (113)) ;
        //-------- @foreachInstructionForGeneration
        cEnumerator_stringlist enumerator_4233 (var_unsortedTransientList, kEnumeration_up) ;
        //--- simple foreach instruction
        while (enumerator_4233.hasCurrentObject ()) {
          //-------- @concatInstructionForGeneration
          var_s.dotAssign_operation (GALGAS_string ("\n"
            "-  ").operator_concat (enumerator_4233.current_mValue (HERE) COMMA_SOURCE_FILE_AT_LINE (115)) COMMA_SOURCE_FILE_AT_LINE (115)) ;
          enumerator_4233.gotoNextObject () ;
        }
        //-------- @errorInstructionForGeneration
        inCompiler->emitSemanticError (constinArgument_inEndOfSourceFile, var_s COMMA_SOURCE_FILE_AT_LINE (117)) ;
      }
    }
  }
}


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


