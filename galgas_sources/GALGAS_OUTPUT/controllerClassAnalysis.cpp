//---------------------------------------------------------------------------*
//                                                                           *
//                    File 'controllerClassAnalysis.cpp'                     *
//                        Generated by version 2.4.7                         *
//                       july 6th, 2013, at 9h58'28"                         *
//                                                                           *
//---------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

#include "controllerClassAnalysis.h"
#include "galgas2/C_Compiler.h"
#include "galgas2/C_galgas_io.h"
#include "galgas2/C_galgas_CLI_Options.h"
#include "utilities/C_PrologueEpilogue.h"

//---------------------------------------------------------------------------*


//---------------------------------------------------------------------------*

#ifndef DO_NOT_GENERATE_CHECKINGS
  #define SOURCE_FILE_AT_LINE(line) "controllerClassAnalysis.gSemantics", line
  #define COMMA_SOURCE_FILE_AT_LINE(line) , SOURCE_FILE_AT_LINE(line)
#else
  #define SOURCE_FILE_AT_LINE(line) 
  #define COMMA_SOURCE_FILE_AT_LINE(line) 
#endif

//---------------------------------------------------------------------------*
//                                                                           *
//                     Routine 'analyzeControllerClass'                      *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_analyzeControllerClass (const GALGAS_controllerClassList_2E_element constinArgument0,
                                     const GALGAS_contextAnalysisStruct constinArgument1,
                                     GALGAS_transientDependencyGraph & ioArgument2,
                                     GALGAS_controllerClassMap & ioArgument3,
                                     C_Compiler * inCompiler
                                     COMMA_LOCATION_ARGS) ;

//---------------------------------------------------------------------------*
//                                                                           *
//                     Routine 'analyzeControllerClass'                      *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_analyzeControllerClass (const GALGAS_controllerClassList_2E_element constinArgument_inController,
                                     const GALGAS_contextAnalysisStruct constinArgument_inContextAnalysisStruct,
                                     GALGAS_transientDependencyGraph & ioArgument_ioTransientDependencyGraph,
                                     GALGAS_controllerClassMap & ioArgument_ioControllerClassMap,
                                     C_Compiler * inCompiler
                                     COMMA_UNUSED_LOCATION_ARGS) {
  GALGAS_actionMap var_actionMap = GALGAS_actionMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (13)) ;
  cEnumerator_lstringlist enumerator_509 (constinArgument_inController.mAttribute_mActionDeclarationList, kEnumeration_up) ;
  while (enumerator_509.hasCurrentObject ()) {
    {
    var_actionMap.modifier_insertKey (enumerator_509.current (HERE).mAttribute_mValue, inCompiler COMMA_SOURCE_FILE_AT_LINE (15)) ;
    }
    enumerator_509.gotoNextObject () ;
  }
  GALGAS_outletClassBindingMap var_bindingMap = GALGAS_outletClassBindingMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (18)) ;
  cEnumerator_outletClassBindingList enumerator_665 (constinArgument_inController.mAttribute_mBindingList, kEnumeration_up) ;
  while (enumerator_665.hasCurrentObject ()) {
    GALGAS_outletClassBindingOptionMap var_outletClassBindingOptionMap = GALGAS_outletClassBindingOptionMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (20)) ;
    cEnumerator_bindingOptionList enumerator_773 (enumerator_665.current_mBindingOptionList (HERE), kEnumeration_up) ;
    while (enumerator_773.hasCurrentObject ()) {
      GALGAS_easyBindingTypeList var_acceptableTypeList = GALGAS_easyBindingTypeList::constructor_emptyList (SOURCE_FILE_AT_LINE (22)) ;
      cEnumerator_attributeASTTypeList enumerator_870 (enumerator_773.current_mAcceptableTypeList (HERE), kEnumeration_up) ;
      while (enumerator_870.hasCurrentObject ()) {
        GALGAS_easyBindingType var_type = callCategoryReader_analyze ((const cPtr_attributeASTType *) enumerator_870.current_mType (HERE).ptr (), constinArgument_inContextAnalysisStruct, inCompiler COMMA_SOURCE_FILE_AT_LINE (24)) ;
        var_acceptableTypeList.addAssign_operation (var_type COMMA_SOURCE_FILE_AT_LINE (25)) ;
        enumerator_870.gotoNextObject () ;
      }
      {
      var_outletClassBindingOptionMap.modifier_insertKey (enumerator_773.current_mBindingOptionName (HERE), var_acceptableTypeList, inCompiler COMMA_SOURCE_FILE_AT_LINE (27)) ;
      }
      enumerator_773.gotoNextObject () ;
    }
    GALGAS_easyBindingTypeAndFormatterList var_acceptableTypeFormatterList = GALGAS_easyBindingTypeAndFormatterList::constructor_emptyList (SOURCE_FILE_AT_LINE (29)) ;
    cEnumerator_attributeASTTypeAndFormatterList enumerator_1235 (enumerator_665.current_mAcceptableTypeFormatterList (HERE), kEnumeration_up) ;
    while (enumerator_1235.hasCurrentObject ()) {
      GALGAS_easyBindingType var_type = callCategoryReader_analyze ((const cPtr_attributeASTType *) enumerator_1235.current_mType (HERE).ptr (), constinArgument_inContextAnalysisStruct, inCompiler COMMA_SOURCE_FILE_AT_LINE (31)) ;
      var_acceptableTypeFormatterList.addAssign_operation (var_type, enumerator_1235.current_mRequiredFormatter (HERE) COMMA_SOURCE_FILE_AT_LINE (32)) ;
      enumerator_1235.gotoNextObject () ;
    }
    {
    var_bindingMap.modifier_insertKey (enumerator_665.current_mBindingName (HERE), var_acceptableTypeFormatterList, var_outletClassBindingOptionMap, inCompiler COMMA_SOURCE_FILE_AT_LINE (34)) ;
    }
    enumerator_665.gotoNextObject () ;
  }
  GALGAS_observablePropertyMap var_observablePropertyMap = GALGAS_observablePropertyMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (37)) ;
  cEnumerator_controllerObservablePropertyList enumerator_1645 (constinArgument_inController.mAttribute_mControllerObservablePropertyList, kEnumeration_up) ;
  while (enumerator_1645.hasCurrentObject ()) {
    GALGAS_lstring var_observationDependencyKey = GALGAS_lstring::constructor_new (GALGAS_string ("controller.").operator_concat (constinArgument_inController.mAttribute_mControllerClassName.reader_string (SOURCE_FILE_AT_LINE (40)) COMMA_SOURCE_FILE_AT_LINE (40)).operator_concat (GALGAS_string (".") COMMA_SOURCE_FILE_AT_LINE (40)).operator_concat (enumerator_1645.current (HERE).mAttribute_mPropertyName.reader_string (SOURCE_FILE_AT_LINE (40)) COMMA_SOURCE_FILE_AT_LINE (40)), enumerator_1645.current (HERE).mAttribute_mPropertyName.mAttribute_location COMMA_SOURCE_FILE_AT_LINE (39)) ;
    {
    ioArgument_ioTransientDependencyGraph.modifier_addNode (var_observationDependencyKey, var_observationDependencyKey.mAttribute_string, inCompiler COMMA_SOURCE_FILE_AT_LINE (43)) ;
    }
    {
    var_observablePropertyMap.modifier_insertKey (enumerator_1645.current (HERE).mAttribute_mPropertyName, callCategoryReader_analyze ((const cPtr_attributeASTType *) enumerator_1645.current (HERE).mAttribute_mType.ptr (), constinArgument_inContextAnalysisStruct, inCompiler COMMA_SOURCE_FILE_AT_LINE (49)), GALGAS_bool (false), var_observationDependencyKey.mAttribute_string, inCompiler COMMA_SOURCE_FILE_AT_LINE (47)) ;
    }
    enumerator_1645.gotoNextObject () ;
  }
  GALGAS_outletClassBindingOptionMap var_controlledObjectAvailableBindingOptionMap = GALGAS_outletClassBindingOptionMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (55)) ;
  cEnumerator_bindingOptionList enumerator_2328 (constinArgument_inController.mAttribute_mControlledObjectBindingOptionList, kEnumeration_up) ;
  while (enumerator_2328.hasCurrentObject ()) {
    GALGAS_easyBindingTypeList var_acceptableTypeList = GALGAS_easyBindingTypeList::constructor_emptyList (SOURCE_FILE_AT_LINE (57)) ;
    cEnumerator_attributeASTTypeList enumerator_2421 (enumerator_2328.current_mAcceptableTypeList (HERE), kEnumeration_up) ;
    while (enumerator_2421.hasCurrentObject ()) {
      GALGAS_easyBindingType var_type = callCategoryReader_analyze ((const cPtr_attributeASTType *) enumerator_2421.current_mType (HERE).ptr (), constinArgument_inContextAnalysisStruct, inCompiler COMMA_SOURCE_FILE_AT_LINE (59)) ;
      var_acceptableTypeList.addAssign_operation (var_type COMMA_SOURCE_FILE_AT_LINE (60)) ;
      enumerator_2421.gotoNextObject () ;
    }
    {
    var_controlledObjectAvailableBindingOptionMap.modifier_insertKey (enumerator_2328.current_mBindingOptionName (HERE), var_acceptableTypeList, inCompiler COMMA_SOURCE_FILE_AT_LINE (62)) ;
    }
    enumerator_2328.gotoNextObject () ;
  }
  {
  ioArgument_ioControllerClassMap.modifier_insertKey (constinArgument_inController.mAttribute_mControllerClassName, constinArgument_inController.mAttribute_mControllerKind, constinArgument_inController.mAttribute_mGenerationKind, var_bindingMap, var_actionMap, var_observablePropertyMap, var_controlledObjectAvailableBindingOptionMap, inCompiler COMMA_SOURCE_FILE_AT_LINE (65)) ;
  }
}


//---------------------------------------------------------------------------*
//                                                                           *
//                    Routine 'analyzeControllerClasses'                     *
//                                                                           *
//---------------------------------------------------------------------------*

void routine_analyzeControllerClasses (const GALGAS_controllerClassList constinArgument_inControllerClassList,
                                       const GALGAS_contextAnalysisStruct constinArgument_inContextAnalysisStruct,
                                       GALGAS_transientDependencyGraph & ioArgument_ioTransientDependencyGraph,
                                       GALGAS_controllerClassMap & outArgument_outControllerClassMap,
                                       C_Compiler * inCompiler
                                       COMMA_UNUSED_LOCATION_ARGS) {
  outArgument_outControllerClassMap.drop () ; // Release 'out' argument
  outArgument_outControllerClassMap = GALGAS_controllerClassMap::constructor_emptyMap (SOURCE_FILE_AT_LINE (84)) ;
  cEnumerator_controllerClassList enumerator_3364 (constinArgument_inControllerClassList, kEnumeration_up) ;
  while (enumerator_3364.hasCurrentObject ()) {
    {
    routine_analyzeControllerClass (enumerator_3364.current (HERE), constinArgument_inContextAnalysisStruct, ioArgument_ioTransientDependencyGraph, outArgument_outControllerClassMap, inCompiler COMMA_SOURCE_FILE_AT_LINE (86)) ;
    }
    enumerator_3364.gotoNextObject () ;
  }
}


//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


