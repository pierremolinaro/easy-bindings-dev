//-----------------------------------------------------------------------------*
//                                                                             *
//                          File 'NameEntity.swift'                            *
//                         Generated by version 0.0.1                          *
//                        july 15th, 2014, at 9h35'26"                         *
//                                                                             *
//-----------------------------------------------------------------------------*

//--- START OF USER ZONE 1


//--- END OF USER ZONE 1

import Cocoa

//---------------------------------------------------------------------------------------------------------------------*

@objc(NameEntity) class NameEntity : PMManagedObject {

  //-------------------------------------------------------------------------------------------------------------------*
  //    Attribute: name                                                                                                *
  //-------------------------------------------------------------------------------------------------------------------*

  var name__explorer : NSTextField?
  var name_observers = NSMutableSet ()
  var name : String =  "Name" {
    willSet {
      undoManager ().registerUndoWithTarget (self,
        selector:"setName:",
        object:name
      )
    }
    didSet {
      name__explorer?.setStringValue (name)
   //--- Notify observers
     name_observers.makeObjectsPerformSelector ("entity_2E_NameEntity_2E_name_didChange")
    }
  }

  func addObserverOf_name (inObserver : AnyObject) {
    name_observers.addObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_name_didChange", to:inObserver, from:self)
  }
  func removeObserverOf_name (inObserver : AnyObject) {
    name_observers.removeObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_name_didChange", to:inObserver, from:self)
  }

  //-------------------------------------------------------------------------------------------------------------------*
  //    Attribute: aValue                                                                                              *
  //-------------------------------------------------------------------------------------------------------------------*

  var aValue__explorer : NSTextField?
  var aValue_observers = NSMutableSet ()
  var aValue__as__number : NSNumber {
    get {
      return NSNumber (longLong:aValue)
    }
    set {
      aValue = newValue.longLongValue ()
    }
  }
    
  var aValue : Int64 =  123 {
    willSet {
      undoManager ().registerUndoWithTarget (self,
        selector:"setAValue__as__number:",
        object:aValue__as__number
      )
    }
    didSet {
      aValue__explorer?.setStringValue (NSString (format:"%lld", aValue))
   //--- Notify observers
     aValue_observers.makeObjectsPerformSelector ("entity_2E_NameEntity_2E_aValue_didChange")
    }
  }

  func addObserverOf_aValue (inObserver : AnyObject) {
    aValue_observers.addObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_aValue_didChange", to:inObserver, from:self)
  }
  func removeObserverOf_aValue (inObserver : AnyObject) {
    aValue_observers.removeObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_aValue_didChange", to:inObserver, from:self)
  }



  //-------------------------------------------------------------------------------------------------------------------*
  //    To one relationship: mRoot                                                                                     *
  //-------------------------------------------------------------------------------------------------------------------*

  var mRoot_observers = NSMutableSet ()
  var mRoot__explorer : NSButton?
  weak var mRoot : MyRootEntity? = nil {
    didSet {
      if oldValue != mRoot {
      //--- Register old value in undo manager
        undoManager ().registerUndoWithTarget (self, selector:"setMRoot:", object:oldValue)
      //--- Update explorer
        if mRoot__explorer != nil {
          updateManagedObjectToOneRelationshipDisplayForKey ("mRoot", button : mRoot__explorer!)
        }
      //--- Set opposite relation ship
        oldValue?.removeObjectFromMNames (self)
        mRoot?.appendToMNames (self)
      }
    }
  }
   
  func addObserverOf_mRoot (inObserver : AnyObject) {
    mRoot_observers.addObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_mRoot_didChange", to:inObserver, from:self)
  }

  func removeObserverOf_mRoot (inObserver : AnyObject) {
    mRoot_observers.removeObject (inObserver)
    NSApp.sendAction ("entity_2E_NameEntity_2E_mRoot_didChange", to:inObserver, from:self)
  }


  //-------------------------------------------------------------------------------------------------------------------*
  //    init                                                                                                           *
  //-------------------------------------------------------------------------------------------------------------------*

  init (entityManager : PMObjectManager) {
    super.init (entityManager:entityManager)
  }

  //-------------------------------------------------------------------------------------------------------------------*
  //    populateExplorerWindow                                                                                         *
  //-------------------------------------------------------------------------------------------------------------------*

  override func populateExplorerWindowWithRect (inout ioRect : NSRect, view : NSView) {
    name__explorer = createEntryForAttributeNamed ("name", ioRect:&ioRect, view:view)
    name__explorer?.setStringValue (name)
    aValue__explorer = createEntryForAttributeNamed ("aValue", ioRect:&ioRect, view:view)
    aValue__explorer?.setStringValue (NSString (format:"%lld", aValue))
   mRoot__explorer = createEntryForToOneRelationshipNamed ("mRoot", ioRect: &ioRect, view: view)
   updateManagedObjectToOneRelationshipDisplayForKey ("mRoot",button:mRoot__explorer!)
   }

  //-------------------------------------------------------------------------------------------------------------------*
  //    clearObjectExplorer                                                                                            *
  //-------------------------------------------------------------------------------------------------------------------*

  override func clearObjectExplorer () {
    name__explorer = nil
    aValue__explorer = nil
    mRoot__explorer = nil
    super.clearObjectExplorer ()
  }

  //-------------------------------------------------------------------------------------------------------------------*
  //    saveIntoDictionary                                                                                             *
  //-------------------------------------------------------------------------------------------------------------------*

  override func saveIntoDictionary (ioDictionary : NSMutableDictionary) {
    super.saveIntoDictionary (ioDictionary)
    ioDictionary.setValue (name, forKey: "name")
    ioDictionary.setValue (NSNumber (longLong:aValue), forKey: "aValue")
    storeEntityInDictionary (mRoot, inRelationshipName:"mRoot", ioDictionary:ioDictionary) ;
  }

  //-------------------------------------------------------------------------------------------------------------------*
  //    setUpWithDictionary                                                                                            *
  //-------------------------------------------------------------------------------------------------------------------*

  override func setUpWithDictionary (inDictionary : NSDictionary,
                                     managedObjectArray : [PMManagedObject]) {
    super.setUpWithDictionary (inDictionary, managedObjectArray:managedObjectArray)
    name = inDictionary.readString ("name")
    aValue = inDictionary.readInt64 ("aValue")
    mRoot = readEntityFromDictionary ("mRoot", inDictionary:inDictionary, managedObjectArray:managedObjectArray) as? MyRootEntity
  }

  //-------------------------------------------------------------------------------------------------------------------*
  //   accessibleObjects                                                                                               *
  //-------------------------------------------------------------------------------------------------------------------*

  override func accessibleObjects (inout objects : [PMManagedObject]) {
    super.accessibleObjects (&objects)
    if mRoot != nil {
      objects += mRoot!
    }
  }

  //-------------------------------------------------------------------------------------------------------------------*

}

//--- START OF USER ZONE 2


//--- END OF USER ZONE 2


