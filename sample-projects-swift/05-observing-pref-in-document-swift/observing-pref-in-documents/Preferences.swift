//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
//  THIS FILE IS GENERATED BY EASY BINDINGS, DO NOT MODIFY IT
//——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

import Cocoa

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————*

var g_Preferences : Preferences? = nil

//————————————————————————————————————————————————————————————————————————————————————————————————————————————————————*

@objc(Preferences) class Preferences : EBObject {

  //····················································································································
  //    Outlets
  //····················································································································

  @IBOutlet var myPrefStringTextField : EBTextField? = nil
 
  //····················································································································
  //    Simple Stored Properties
  //····················································································································

  var myPrefString = EBStoredProperty_String ("pref string")

  //····················································································································
  //    Stored Array Properties
  //····················································································································


  //····················································································································
  //    Transient properties
  //····················································································································

  var prefTransientString = EBTransientProperty_String ()


  //····················································································································
  //    Array Controllers
  //····················································································································



  //····················································································································
  //    Init
  //····················································································································

  override init () {
    super.init ()
    g_Preferences = self ;
  //--- Read from preferences
    myPrefString.readInPreferencesWithKey ("Preferences:myPrefString")
  //--- Property validation function
  //---
    NSNotificationCenter.defaultCenter ().addObserver (self,
     selector:#selector(Preferences.applicationWillTerminateAction(_:)),
     name:NSApplicationWillTerminateNotification,
     object:nil
    )
  //--- Extern functions
  }

  //····················································································································
  //    awakeFromNib
  //····················································································································

  override func awakeFromNib () {
  //--- Check myPrefStringTextField' outlet not nil
    if nil == myPrefStringTextField {
      presentErrorWindow (#file, line:#line, errorMessage:"the 'myPrefStringTextField' outlet is nil")
    }
  //--- Install compute functions for transients
    prefTransientString.readModelFunction = { [weak self] in
      if let unwSelf = self {
        let kind = unwSelf.myPrefString.prop.kind ()
        switch kind {
        case .noSelectionKind :
          return .noSelection
        case .multipleSelectionKind :
          return .multipleSelection
        case .singleSelectionKind :
          switch (unwSelf.myPrefString.prop) {
          case (.singleSelection (let v0)) :
            return .singleSelection (compute_Preferences_prefTransientString (v0))
          default :
            return .noSelection
          }
        }
      }else{
        return .noSelection
      }
    }
  //--- Install property observers for transients
    self.myPrefString.addEBObserver (prefTransientString)
  //--- Install bindings
    myPrefStringTextField?.bind_value (self.myPrefString, file:#file, line:#line, sendContinously:false)
  //--- Install multiple bindings
  //--------------------------- Array controller
  //--------------------------- Set targets / actions
  //--- Extern functions
  }
  
  //····················································································································
  //    applicationWillTerminateAction
  //····················································································································

  func applicationWillTerminateAction (_ : NSNotification) {
    myPrefString.storeInPreferencesWithKey ("Preferences:myPrefString")
  }

  //····················································································································

}

//—————————————————————————————————————————————————————————————————————————————————————————————————————————————————————*

